{% extends "DnDSite/base.html" %}
{% load static %}

{% block title %}Добавить монстра - D&D Справочник{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/add_monster.css' %}">
{% endblock %}

{% block extra_js %}
<script src="/static/js/add_monster.js"></script>
{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row mb-4">
        <div class="col">
            <h1 class="display-5 fw-bold">
                <i class="bi bi-plus-circle text-success"></i> Добавить нового монстра
            </h1>
            <p class="lead text-muted">Создайте собственного монстра для вашей кампании D&D</p>
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow border-0">
                <div class="card-body p-4">
                    <form method="post" id="monsterForm" novalidate>
                        {% csrf_token %}
                        {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {% for error in form.non_field_errors %}
                            <p class="mb-0">{{ error }}</p>
                            {% endfor %}
                        </div>
                        {% endif %}

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="text" name="name" class="form-control" id="id_name"
                                           placeholder="Название монстра" required>
                                    <label for="id_name">Название</label>
                                    {% if form.name.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.name.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <select name="size" class="form-select" id="id_size" required>
                                        <option value="" selected>Выберите размер</option>
                                        <option value="Tiny">Крошечный</option>
                                        <option value="Small">Маленький</option>
                                        <option value="Medium">Средний</option>
                                        <option value="Large">Большой</option>
                                        <option value="Huge">Огромный</option>
                                        <option value="Gargantuan">Гигантский</option>
                                    </select>
                                    {% if form.size.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.size.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="col-12">
                                <div class="form-floating mb-3">
                                    <input type="text" name="type" class="form-control" id="id_type"
                                           placeholder="Тип монстра" required>
                                    <label for="id_type">Тип</label>
                                    <div class="form-text">Например: дракон, гуманоид, нежить, зверь и т.д.</div>
                                    {% if form.type.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.type.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="number" name="hit_points" class="form-control" id="id_hit_points"
                                           placeholder="Уровни жизней" min="1" required>
                                    <label for="id_hit_points">Уровни жизней (HP)</label>
                                    <div class="form-text">Количество хитов</div>
                                    {% if form.hit_points.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.hit_points.errors }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <h4 class="mt-5 mb-3 border-bottom pb-2">
                            Характеристики
                        </h4>

                        <div class="row g-3">
                            <div class="col-md-4 col-lg-2">
                                <div class="form-floating mb-3">
                                    <input type="number" name="strength" class="form-control stat-input"
                                           id="id_strength" placeholder="Сила" min="1" max="30" required>
                                    <label for="id_strength">Сила</label>
                                </div>
                            </div>

                            <div class="col-md-4 col-lg-2">
                                <div class="form-floating mb-3">
                                    <input type="number" name="dexterity" class="form-control stat-input"
                                           id="id_dexterity" placeholder="Ловкость" min="1" max="30" required>
                                    <label for="id_dexterity">Ловкость</label>
                                </div>
                            </div>

                            <div class="col-md-4 col-lg-2">
                                <div class="form-floating mb-3">
                                    <input type="number" name="constitution" class="form-control stat-input"
                                           id="id_constitution" placeholder="Телосложение" min="1" max="30" required>
                                    <label for="id_constitution">Телосложение</label>
                                </div>
                            </div>

                            <div class="col-md-4 col-lg-2">
                                <div class="form-floating mb-3">
                                    <input type="number" name="intelligence" class="form-control stat-input"
                                           id="id_intelligence" placeholder="Интеллект" min="1" max="30" required>
                                    <label for="id_intelligence">Интеллект</label>
                                </div>
                            </div>

                            <div class="col-md-4 col-lg-2">
                                <div class="form-floating mb-3">
                                    <input type="number" name="wisdom" class="form-control stat-input"
                                           id="id_wisdom" placeholder="Мудрость" min="1" max="30" required>
                                    <label for="id_wisdom">Мудрость</label>
                                </div>
                            </div>

                            <div class="col-md-4 col-lg-2">
                                <div class="form-floating mb-3">
                                    <input type="number" name="charisma" class="form-control stat-input"
                                           id="id_charisma" placeholder="Харизма" min="1" max="30" required>
                                    <label for="id_charisma">Харизма</label>
                                </div>
                            </div>
                        </div>

                        <h4 class="mt-5 mb-3 border-bottom pb-2">
                            <i class="bi bi-shield"></i> Класс брони
                        </h4>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <select name="armor-type" class="form-select" id="id_armor_type">
                                        <option value="natural" selected>Природная броня</option>
                                        <option value="armor">Доспехи</option>
                                        <option value="magic">Магическая защита</option>
                                        <option value="dex">Ловкость</option>
                                        <option value="other">Другое</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="number" name="armor-value" class="form-control"
                                           id="id_armor_value" placeholder="Значение брони" min="0">
                                    <label for="id_armor_value">Значение брони</label>
                                </div>
                            </div>
                        </div>

                        <h4 class="mt-5 mb-3 border-bottom pb-2">
                            <i class="bi bi-speedometer2"></i> Скорость
                        </h4>

                        <div class="row g-3">
                            <div class="col-12">
                                <div class="form-floating mb-3">
                                    {{ speeds_form.speeds }}
                                    <label for="{{ speeds_form.speeds.id_for_label }}">{{ speeds_form.speeds.label }}</label>
                                    <div class="form-text">
                                        {{ speeds_form.speeds.help_text|safe }}
                                        Примеры:<br>
                                        <code>walk: 30</code> - Ходьба: 30 футов<br>
                                        <code>fly: 30</code> - Полёт: 30 футов<br>
                                        <code>swim: 20</code> - Плавание: 20 футов<br>
                                        <code>climb: 30</code> - Лазание: 30 футов<br>
                                        <code>burrow: 10</code> - Рытьё: 10 футов<br>
                                        <code>dig: 10</code> - Капая: 10 футов<br>
                                        <code>hover: 0</code> - Парение (не требует перемещения)
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between mt-5">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-save"></i> Сохранить монстра
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="card mt-4 border-info">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="bi bi-lightbulb"></i> Советы по созданию монстра</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <h6><i class="bi bi-1-circle"></i> Баланс характеристик</h6>
                            <p class="small">Значения характеристик от 1 до 30. Среднее значение - 10.</p>
                        </div>
                        <div class="col-md-4">
                            <h6><i class="bi bi-2-circle"></i> Класс брони</h6>
                            <p class="small">AC 10-12 - слабая защита, 13-15 - средняя, 16+ - высокая.</p>
                        </div>
                        <div class="col-md-4">
                            <h6><i class="bi bi-3-circle"></i> Здоровье</h6>
                            <p class="small">Низкое: 1-30, Среднее: 31-100, Высокое: 101+ HP.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}